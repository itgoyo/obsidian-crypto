/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var y=Object.defineProperty;var B=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var P=Object.prototype.hasOwnProperty;var T=(l,o)=>{for(var t in o)y(l,t,{get:o[t],enumerable:!0})},S=(l,o,t,e)=>{if(o&&typeof o=="object"||typeof o=="function")for(let s of w(o))!P.call(l,s)&&s!==t&&y(l,s,{get:()=>o[s],enumerable:!(e=B(o,s))||e.enumerable});return l};var v=l=>S(y({},"__esModule",{value:!0}),l);var E={};T(E,{default:()=>d});module.exports=v(E);var r=require("obsidian"),D={updateInterval:60,enableBTC:!0,enableETH:!0,enableBNB:!0,customCryptos:[]},d=class extends r.Plugin{constructor(){super(...arguments);this.statusBarItems=new Map;this.priceCache=new Map;this.updateInterval=null}async onload(){console.log("Loading Crypto Price Plugin"),await this.loadSettings(),this.initializeStatusBar(),await this.updatePrices(),this.startAutoUpdate(),this.addSettingTab(new C(this.app,this)),console.log("Crypto Price Plugin loaded")}onunload(){console.log("Unloading Crypto Price Plugin"),this.updateInterval&&window.clearInterval(this.updateInterval)}async loadSettings(){this.settings=Object.assign({},D,await this.loadData())}async saveSettings(){await this.saveData(this.settings),this.clearStatusBar(),this.initializeStatusBar(),this.startAutoUpdate()}initializeStatusBar(){let t=[];this.settings.enableBTC&&t.push("BTC"),this.settings.enableETH&&t.push("ETH"),this.settings.enableBNB&&t.push("BNB");for(let e of this.settings.customCryptos)e.enabled&&t.push(e.symbol);for(let e of t){let s=this.addStatusBarItem();s.setText(`${e}: Loading...`),s.addClass("crypto-status-item"),s.title=`Click to refresh ${e} price`,s.addEventListener("click",()=>{this.updatePrices()}),this.statusBarItems.set(e,s)}}clearStatusBar(){this.statusBarItems.forEach(t=>t.remove()),this.statusBarItems.clear()}startAutoUpdate(){this.updateInterval&&window.clearInterval(this.updateInterval),this.updateInterval=window.setInterval(()=>{this.updatePrices()},this.settings.updateInterval*1e3)}async fetchPrice(t){try{let e=`${t}USDT`,s=await fetch(`https://api.binance.com/api/v3/ticker/24hr?symbol=${e}`);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);let p=await s.json();return{symbol:t,price:parseFloat(p.lastPrice),priceChange:parseFloat(p.priceChange),priceChangePercent:parseFloat(p.priceChangePercent)}}catch(e){return console.error(`Failed to fetch ${t} price:`,e),null}}async updatePrices(){let t=[];this.settings.enableBTC&&t.push("BTC"),this.settings.enableETH&&t.push("ETH"),this.settings.enableBNB&&t.push("BNB");for(let e of this.settings.customCryptos)e.enabled&&t.push(e.symbol);for(let e of t){let s=await this.fetchPrice(e);s&&(this.priceCache.set(e,s),this.updateStatusBarItem(e,s))}}updateStatusBarItem(t,e){let s=this.statusBarItems.get(t);if(!s)return;let p=this.formatPrice(e.price),u=e.priceChangePercent>0?"\u2191":e.priceChangePercent<0?"\u2193":"\u2192",g=e.priceChangePercent>0?"crypto-up":e.priceChangePercent<0?"crypto-down":"crypto-neutral";s.setText(`${t} ${p}`),s.title=`${t}/USDT
Price: $${p}
24h Change: ${e.priceChangePercent.toFixed(2)}%`,s.removeClass("crypto-up","crypto-down","crypto-neutral"),s.addClass(g);let h=s.querySelector(".crypto-arrow");h&&h.remove();let n=s.createSpan({cls:"crypto-arrow"});n.setText(` ${u}`),s.appendChild(n)}formatPrice(t){return t>=1e3?t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):t>=1?t.toFixed(4):t.toFixed(8)}},C=class extends r.PluginSettingTab{constructor(t,e){super(t,e);this.plugin=e}display(){let{containerEl:t}=this;t.empty(),t.createEl("h2",{text:"Crypto Price Tracker Settings"}),new r.Setting(t).setName("Update interval").setDesc("Price update interval in seconds (minimum 10)").addText(n=>n.setPlaceholder("60").setValue(String(this.plugin.settings.updateInterval)).onChange(async i=>{let a=parseInt(i);!isNaN(a)&&a>=10&&(this.plugin.settings.updateInterval=a,await this.plugin.saveSettings())})),new r.Setting(t).setName("Show BTC").setDesc("Display Bitcoin price in status bar").addToggle(n=>n.setValue(this.plugin.settings.enableBTC).onChange(async i=>{this.plugin.settings.enableBTC=i,await this.plugin.saveSettings()})),new r.Setting(t).setName("Show ETH").setDesc("Display Ethereum price in status bar").addToggle(n=>n.setValue(this.plugin.settings.enableETH).onChange(async i=>{this.plugin.settings.enableETH=i,await this.plugin.saveSettings()})),new r.Setting(t).setName("Show BNB").setDesc("Display Binance Coin price in status bar").addToggle(n=>n.setValue(this.plugin.settings.enableBNB).onChange(async i=>{this.plugin.settings.enableBNB=i,await this.plugin.saveSettings()})),new r.Setting(t).setName("Manual refresh").setDesc("Update all prices immediately").addButton(n=>n.setButtonText("Refresh prices").onClick(async()=>{await this.plugin.updatePrices()})),t.createEl("hr"),t.createEl("h3",{text:"Custom Cryptocurrencies"});let e="",s="",p=t.createDiv({cls:"crypto-add-container"});if(new r.Setting(p).setName("Add new cryptocurrency").setDesc("Enter crypto symbol (e.g., SOL, DOGE, XRP)").addText(n=>n.setPlaceholder("Symbol (e.g., SOL)").onChange(i=>{e=i.trim().toUpperCase()})).addText(n=>n.setPlaceholder("Display name (optional)").onChange(i=>{s=i.trim()})).addButton(n=>n.setButtonText("Add").setCta().onClick(async()=>{if(e){if(this.plugin.settings.customCryptos.some(a=>a.symbol===e))return;this.plugin.settings.customCryptos.push({symbol:e,displayName:s||e,enabled:!0}),await this.plugin.saveSettings(),this.display()}})),this.plugin.settings.customCryptos.length>0){t.createEl("h4",{text:"Added cryptocurrencies"});let n=t.createDiv({cls:"crypto-list-container"});for(let i=0;i<this.plugin.settings.customCryptos.length;i++){let a=this.plugin.settings.customCryptos[i];new r.Setting(n).setName(a.displayName).setDesc(`${a.symbol}/USDT`).addToggle(c=>c.setValue(a.enabled).onChange(async m=>{a.enabled=m,await this.plugin.saveSettings()})).addButton(c=>c.setButtonText("Delete").setWarning().onClick(async()=>{this.plugin.settings.customCryptos.splice(i,1),await this.plugin.saveSettings(),this.display()}))}}t.createEl("hr");let u=t.createDiv({cls:"crypto-price-info"});u.createEl("h3",{text:"Current Prices"});let g=()=>{u.empty(),u.createEl("h3",{text:"Current Prices"});let n=[];this.plugin.settings.enableBTC&&n.push({symbol:"BTC",name:"Bitcoin"}),this.plugin.settings.enableETH&&n.push({symbol:"ETH",name:"Ethereum"}),this.plugin.settings.enableBNB&&n.push({symbol:"BNB",name:"Binance Coin"});for(let i of this.plugin.settings.customCryptos)i.enabled&&n.push({symbol:i.symbol,name:i.displayName});for(let{symbol:i,name:a}of n){let c=this.plugin.priceCache.get(i);if(c){let m=u.createDiv({cls:"crypto-price-item"}),b=c.priceChangePercent>0?"\u2191":c.priceChangePercent<0?"\u2193":"\u2192",f=c.priceChangePercent>0?"green":c.priceChangePercent<0?"red":"gray";m.innerHTML=`
						<strong>${a} (${i}/USDT):</strong> 
						$${this.plugin.formatPrice(c.price)} 
						<span style="color: ${f}">
							${b} ${c.priceChangePercent.toFixed(2)}%
						</span>
					`}}};g();let h=window.setInterval(g,1e3);this.containerEl.addEventListener("unload",()=>{window.clearInterval(h)})}};
